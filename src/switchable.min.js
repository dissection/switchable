"use strict";!function(e,t){function n(t){return this.each(function(){new s(e(this),t)})}var s=function(t,n){var i,a=this,o=!0;if(a.el=e(t),i=a.options=e.extend({},s.DEFAULTS,n||{}),a.addClassfnc(),i.visible<i.step&&(i.visible=i.step),a.nav=a.el.find("."+i.navItem),a.main=a.el.find("."+i.mainClass),i.step=Math.max(i.step||1,1),a.len=a.main.size(),a.content=a.el.find("."+i.contentClass),a.mainWidth=a.main.outerWidth(i.includeMargin),a.mainHeight=a.main.outerHeight(i.includeMargin),o=i.step<a.len,"tab"==i.type&&i.navSelectedClass&&a.nav.length>0){var l=-1;a.nav.each(function(t){var n=e(this);n.hasClass(i.navSelectedClass)&&(-1==l?l=t:n.removeClass(i.navSelectedClass))}),l>-1&&(i.defaultPanel=l)}if(i.isPingtung&&(i.width=e(window).width()),i.width&&(a.mainWidth=i.width),a.mainHeight=a.main.outerHeight(i.includeMargin),i.height&&(a.mainHeight=i.height),a.cloneCount=i.visible,i.seamlessLoop&&o){for(var c=[],r=[],p=a.cloneCount,u=0;p>u;u++)c.push(a.main.eq(u).clone().attr("data-switchable-clone",p+u).data("switchable-clone-from",p+u)),r.push(a.main.eq(a.len-(u+1)).clone().attr("data-switchable-clone",a.len+u).data("switchable-clone-from",a.len+u));for(var m=0;p>m;m++)a.content.prepend(r[m]).append(c[m]);a.main=a.el.find("."+i.mainClass)}a.main.each(function(t){e(this).data("switchable-idx",t)});var d=i.defaultPanel;a.last=d,a.current=d,a.isInit=!0,i.seamlessLoop&&o?a.switchTo(d,d+a.cloneCount):a.switchTo(d,d),a.autoInterval=null,a.eventTimer=null,o&&(a.autoPlay(),a.eventBind())};s.VERSION="1.1.0",s.DEFAULTS={type:"tab",direction:"left",contentClass:"ui-switchable-panel-main",mainClass:"ui-switchable-panel",mainSelectedClass:"ui-switchable-panel-selected",navItem:"ui-switchable-item",navSelectedClass:"ui-switchable-selected",prevClass:"ui-switchable-prev",nextClass:"ui-switchable-next",contentPage:"ui-switchable-page",contentPageIsConceal:!1,imgscrollClass:"ui-switchable-imgscroll-img",imgscrollItemClass:"ui-switchable-imgscroll-item",imgscrollDataSrc:"data-src",isAutoPlay:!1,mouseenterStopPlay:!0,playDirection:"next",event:"mouseover",speed:400,delay:150,defaultPanel:0,stayTime:5e3,includeMargin:!1,width:0,height:0,step:1,seamlessLoop:!1,visible:1,easing:"swing",hasSetup:!1,hasArrow:!1,arrowClass:"ui-switchable-arrow",navIframe:"data-iframe",callback:null,onNext:null,onPrev:null},s.prototype.addClassfnc=function(){},s.prototype.eventBind=function(){var t=this,n=t.options;t.nav.each(function(s){var i=e(this);i.on(n.event,function(){e(this);clearInterval(t.autoInterval),0===n.delay?(t.current=s,t.switchTo(s,n.seamlessLoop?s+t.cloneCount:s)):(clearTimeout(t.eventTimer),t.eventTimer=setTimeout(function(){t.current=s,t.switchTo(s,n.seamlessLoop?s+t.cloneCount:s)},n.delay))}).on("mouseleave",function(){clearTimeout(t.eventTimer),n.mouseenterStopPlay||t.autoPlay()})}),t.el.on("mouseenter",function(){n.contentPageIsConceal&&e("."+n.contentPage).show(),n.mouseenterStopPlay&&clearInterval(t.autoInterval)}).on("mouseleave",function(){n.contentPageIsConceal&&e("."+n.contentPage).hide(),n.mouseenterStopPlay&&t.autoPlay()}),t.page()},s.prototype.switchTo=function(e,t){var n=this;n.options;"undefined"==typeof e||"undefined"==typeof t||(n.switchNavTo(e),n.switchMainTo(t))},s.prototype.switchNavTo=function(e){var t=this,n=t.options;t.nav.removeClass(n.navSelectedClass),t.nav.eq(e).addClass(n.navSelectedClass)},s.prototype.switchMainTo=function(t){var n=this,s=n.options;if(n.iframefnc(t),"imgscroll"!=s.type&&(n.main.removeClass(s.mainSelectedClass),n.main.eq(t).addClass(s.mainSelectedClass)),n.isInit||n.last!=t){if(n.switchType(t),null!=s.callback){var i=t,a=n.main.eq(i),o=n.nav.eq(i);s.seamlessLoop&&n.main.each(function(){return i==e(this).data("switchable-clone-from")?(e(this).replaceWith(a.clone()),!1):void 0}),s.callback.call(n,t,o,a)}n.last=t}},s.prototype.switchType=function(t){var n=this,s=n.options;switch(s.type){case"tab":n.tab(t);break;case"focus":n.focus(t);break;case"slider":n.slider(t);break;case"imgscroll":n.imgscroll(t);break;default:e.error("选择类型有误")}},s.prototype.switchDefault=function(e){var t=this;t.main.hide(),t.main.eq(e).show()},s.prototype.tab=function(e){var t=this,n=t.options;if(n.hasSetup||t.switchDefault(e),n.hasArrow){var s=n.arrowClass,i=t.nav.eq(e).outerWidth(!0)*e;if(t.isInit){var a=t.nav.parent().parent();a.prepend('<div class="'+s+'"><b></b></div>').css({position:"relative"}),t.el.find("."+s).css({left:i}),t.isPlayLock=!1}else setTimeout(function(){t.isPlayLock=!1},n.speed),t.el.find("."+s).stop(!0).animate({left:i},n.speed,n.easing)}t.isInit=!1},s.prototype.focus=function(t){var n=this,s=n.options;n.isInit?(n.main.parent().css({position:"relative"}),n.main.css({position:"absolute",zIndex:0,opacity:0}).show(),n.main.eq(t).css({zIndex:1,opacity:1}),n.isPlayLock=!1):(setTimeout(function(){n.isPlayLock=!1},s.speed),n.main.eq(n.last).css({zIndex:0}).stop(!0).animate({opacity:1},s.speed,s.easing,function(){e(this).css("opacity",0)})),n.main.eq(t).css({zIndex:1}).stop(!0).animate({opacity:1},s.speed,s.easing),n.isInit=!1},s.prototype.slider=function(e){var t=this,n=t.options,s=t.mainWidth,i=t.mainHeight,a=t.content,o=s*e,l=i*e;t.isInit?("left"==n.direction?(t.main.css({"float":"left",width:s}),a.css(n.seamlessLoop?{width:s*(t.len+2*t.cloneCount)}:{width:s*t.len}),a.css({left:-o})):"top"==n.direction&&a.css({top:-l}),a.parent().css({position:"relative"}),a.css({position:"absolute"}),t.isInit=!1,t.isPlayLock=!1):(setTimeout(function(){t.isPlayLock=!1},n.speed),"left"==n.direction?a.stop(!0).animate({left:-o},n.speed,n.easing):"top"==n.direction&&a.stop(!0).animate({top:-l},n.speed,n.easing))},s.prototype.imgscroll=function(t){var n=this,s=n.options,i=n.mainWidth,a=n.el.find("."+s.imgscrollClass);if(n.isInit){n.content.css({position:"absolute",width:i*n.len}),n.main.css({"float":"left"});var o=s.mainSelectedClass;if(n.main.eq(0).addClass(o),!a.attr("src")){var l=n.el.find("."+s.imgscrollItemClass).eq(0).attr(s.imgscrollDataSrc);a.attr("src",l)}n.main.bind(s.event,function(){var t=e(this),i=t.find("."+s.imgscrollItemClass).attr(s.imgscrollDataSrc);n.main.removeClass(o),t.addClass(o),a.attr("src",i)}),n.isInit=!1,n.isPlayLock=!1}else{setTimeout(function(){n.isPlayLock=!1},s.speed);var c=n.current*i;n.content.stop(!0).animate({left:-c},s.speed)}},s.prototype.page=function(){var e=this,t=e.options,n=e.el.find("."+t.prevClass),s=e.el.find("."+t.nextClass);n.on("click",function(t){e.isPlayLock&&e.content&&e.content.length>0||(e.isPlayLock=!0,e.prev(),t.stopPropagation())}),s.on("click",function(t){e.isPlayLock&&e.content&&e.content.length>0||(e.isPlayLock=!0,e.next(),t.stopPropagation())})},s.prototype.next=function(){var t=this,n=t.options;t.current=t.current+n.step,t.offsetIndex();var s=0;!n.seamlessLoop&&(s=-n.visible+n.step),t.current>=t.len+s&&(t.current=0);var i=n.visible;!n.seamlessLoop&&t.current+i>t.len&&(t.current=t.len>i?t.len-i:0);var a=n.seamlessLoop?t.current+t.cloneCount:t.current;t.switchTo(t.current,a),e.isFunction(n.onNext)&&n.onNext.call(t)},s.prototype.prev=function(){var t=this,n=t.options;n.seamlessLoop?t.offsetIndex(!0):(t.current-=n.step,t.current<0&&(t.current=t.current>-n.step?0:t.len-n.visible));var s=n.seamlessLoop?t.current+t.cloneCount:t.current;t.switchTo(t.current,s),e.isFunction(n.onPrev)&&n.onPrev.call(t)},s.prototype.offsetIndex=function(e){var t=this,n=t.content,s=t.options,i=t.mainWidth,a=t.mainHeight,o=null,l=null,c=null;e&&s.seamlessLoop?(c=t.current,t.current<=0?(c=t.len-s.step+t.current,o=-((t.len+(t.cloneCount+t.current))*i),l=-((t.len+(t.cloneCount+t.current))*a)):c-=s.step,t.current=c):t.current>=t.len&&s.seamlessLoop&&(c=t.current-t.len,o=-((c+t.cloneCount-s.step)*i),l=-((c+t.cloneCount-s.step)*a),t.current=c),null!=o&&"left"==s.direction?n.css({left:o}):null!=l&&"top"==s.direction&&n.css({top:l})},s.prototype.autoPlay=function(){var e=this;e.options.isAutoPlay&&e.startPlay()},s.prototype.startPlay=function(){var e=this,t=e.options;e.stopPlay(),e.autoInterval=setInterval(function(){e.main.length<=t.step?e.stopPlay():"prev"==t.playDirection?e.prev():e.next()},t.stayTime)},s.prototype.stopPlay=function(){var e=this;clearInterval(e.autoInterval)},s.prototype.iframefnc=function(e){var t=this,n=t.options,s=t.main.eq(e),i=t.nav.eq(n.seamlessLoop?e-t.cloneCount:e),a=i.attr(n.navIframe);if(a){var o=document.createElement("iframe");o.src=a,o.border=0,o.frameborder="no",o.marginwidth=0,o.marginheight=0,s.html(o),i.removeAttr(n.navIframe)}},e.fn.switchable=n,e.fn.switchable.Constructor=s}(jQuery);